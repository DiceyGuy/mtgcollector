{"ast":null,"code":"import Tesseract from 'tesseract.js';\n\n// üöÄ CLAUDE VISION PROXY POWERED MTG SCANNER - NO CORS! üöÄ\nclass ClaudeVisionService {\n  constructor() {\n    console.log('üöÄ CLAUDE VISION PROXY POWERED MTG SCANNER initialized!');\n    this.canvas = null;\n    this.ctx = null;\n    this.debugMode = true;\n\n    // ü§ñ CLAUDE VISION PROXY CONFIGURATION\n    this.proxyUrl = 'http://localhost:3001/api/claude-vision';\n    this.proxyHealthUrl = 'http://localhost:3001/health';\n\n    // Rate limiting for Claude API calls\n    this.lastClaudeCall = 0;\n    this.claudeCallDelay = 2000; // 2 seconds between calls\n    this.claudeEnabled = true;\n\n    // Cache for Claude results\n    this.claudeResultCache = new Map();\n    this.cacheTimeout = 8000; // 8 seconds cache\n\n    // Enhanced known cards database for OCR fallback\n    this.knownCards = new Set(['lightning bolt', 'black lotus', 'ancestral recall', 'time walk', 'mox pearl', 'mox sapphire', 'mox jet', 'mox ruby', 'mox emerald', 'counterspell', 'giant growth', 'dark ritual', 'healing salve', 'terror', 'disenchant', 'general ferrous rokiric', 'tarmogoyf', 'snapcaster mage', 'delver of secrets', 'monastery swiftspear', 'young pyromancer', 'lightning helix', 'path to exile', 'swords to plowshares', 'brainstorm', 'ponder', 'preordain', 'serum visions', 'solemn simulacrum', 'meteoric mace', 'cut your losses', 'blood researcher', 'fault line', 'okaun eye of chaos', 'roghakh son of rohgahh', 'gilded lotus', 'sol ring', 'mana crypt', 'chrome mox', 'mox diamond', 'lotus petal', 'demonic tutor', 'vampiric tutor', 'mystical tutor', 'enlightened tutor', 'force of will', 'force of negation', 'mana drain', 'cryptic command']);\n\n    // MTG card physical dimensions\n    this.cardDimensions = {\n      physicalWidth: 2.5,\n      physicalHeight: 3.5,\n      ratio: 2.5 / 3.5,\n      nameZone: {\n        x: 0.04,\n        y: 0.025,\n        width: 0.78,\n        height: 0.09\n      }\n    };\n\n    // Check proxy server on initialization\n    this.checkProxyServer();\n  }\n  async checkProxyServer() {\n    try {\n      const response = await fetch(this.proxyHealthUrl);\n      const data = await response.json();\n      if (data.status === 'OK') {\n        console.log('‚úÖ Claude Vision Proxy Server is running!');\n        if (data.apiKeyConfigured) {\n          console.log('‚úÖ Proxy server has Claude API key configured');\n          this.claudeEnabled = true;\n        } else {\n          console.warn('‚ö†Ô∏è Proxy server needs Claude API key configuration');\n          this.claudeEnabled = false;\n        }\n      }\n    } catch (error) {\n      console.warn('‚ö†Ô∏è Claude Vision Proxy Server not running - using OCR fallback only');\n      console.warn('üìã To enable Claude Vision: npm start in Claude Proxy Server directory');\n      this.claudeEnabled = false;\n    }\n  }\n\n  // üéØ MAIN CLAUDE VISION POWERED RECOGNITION METHOD\n  async processVideoFrame(videoElement) {\n    this.log('üé• Processing video frame with CLAUDE VISION PROXY + OCR HYBRID...');\n    try {\n      // Capture frame\n      const canvas = document.createElement('canvas');\n      const ctx = canvas.getContext('2d');\n      canvas.width = videoElement.videoWidth;\n      canvas.height = videoElement.videoHeight;\n      ctx.drawImage(videoElement, 0, 0);\n      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n      this.log('üì∑ Frame captured', `${imageData.width}x${imageData.height}`);\n\n      // üéØ CLAUDE VISION FIRST APPROACH\n      const startTime = Date.now();\n\n      // Step 1: Try Claude Vision API via Proxy (Primary)\n      let claudeResult = null;\n      if (this.claudeEnabled && this.shouldCallClaude()) {\n        this.log('ü§ñ Step 1: Calling Claude Vision via Proxy...');\n        claudeResult = await this.callClaudeVisionProxy(canvas);\n      } else if (!this.claudeEnabled) {\n        this.log('‚ö†Ô∏è Step 1: Claude Vision disabled (proxy not running)...');\n      } else {\n        this.log('‚è≥ Step 1: Skipping Claude (rate limit - waiting 2 seconds)...');\n      }\n\n      // Step 2: OCR Fallback if needed\n      let ocrResult = null;\n      if (!claudeResult || !claudeResult.success) {\n        this.log('üîç Step 2: Running enhanced OCR fallback...');\n        ocrResult = await this.enhancedOCRFallback(imageData);\n      }\n\n      // Step 3: Select best result\n      const finalResult = this.selectBestHybridResult(claudeResult, ocrResult, startTime);\n      this.log('üéØ Final CLAUDE-POWERED result:', {\n        method: finalResult.method,\n        confidence: finalResult.confidence,\n        cardName: finalResult.cardName\n      });\n      return finalResult;\n    } catch (error) {\n      this.log('‚ùå Claude-powered processing error:', error);\n      return {\n        hasCard: false,\n        message: 'Scanner processing error: ' + error.message,\n        reason: 'PROCESSING_ERROR',\n        details: error.message\n      };\n    }\n  }\n  shouldCallClaude() {\n    const now = Date.now();\n    const timeSinceLastCall = now - this.lastClaudeCall;\n    return timeSinceLastCall >= this.claudeCallDelay;\n  }\n  async callClaudeVisionProxy(canvas) {\n    const startTime = Date.now();\n    try {\n      this.log('ü§ñ Calling Claude Vision via Proxy Server...');\n\n      // Convert canvas to base64\n      const base64Image = canvas.toDataURL('image/jpeg', 0.8).split(',')[1];\n\n      // Call the proxy server instead of Claude API directly\n      const response = await fetch(this.proxyUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          base64Image: base64Image,\n          prompt: `Analyze this Magic: The Gathering card image and identify the exact card name.\n\nINSTRUCTIONS:\n- Look carefully at the card name in the title area (top section of the card)\n- Return ONLY the exact card name as it appears on the card\n- If the text is unclear or unreadable, return \"UNCLEAR\"\n- Examples: \"Lightning Bolt\", \"Gilded Lotus\", \"Roghakh, Son of Rohgahh\"\n\nCard name:`\n        })\n      });\n      this.lastClaudeCall = Date.now();\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({\n          error: 'Unknown error'\n        }));\n        throw new Error(`Proxy server error: ${response.status} - ${errorData.error || 'Unknown error'}`);\n      }\n      const data = await response.json();\n      const cardName = data.cardName;\n      this.log('üéØ Claude Vision Proxy response:', cardName);\n\n      // Validate response\n      if (cardName === 'UNCLEAR' || cardName.length < 2) {\n        return {\n          success: false,\n          confidence: 0,\n          cardName: '',\n          method: 'claude_vision_unclear',\n          processingTime: Date.now() - startTime,\n          reason: 'Image unclear to Claude Vision'\n        };\n      }\n\n      // Success!\n      return {\n        success: true,\n        confidence: data.confidence || 95,\n        cardName: cardName,\n        method: 'claude_vision_proxy',\n        processingTime: Date.now() - startTime,\n        apiCall: true\n      };\n    } catch (error) {\n      this.log('‚ùå Claude Vision Proxy error:', error.message);\n      return {\n        success: false,\n        confidence: 0,\n        cardName: '',\n        method: 'claude_vision_proxy_error',\n        processingTime: Date.now() - startTime,\n        error: error.message\n      };\n    }\n  }\n  async enhancedOCRFallback(imageData) {\n    this.log('üîç Running enhanced OCR fallback...');\n    try {\n      // Extract name zone\n      const nameZone = this.extractNameZone(imageData);\n\n      // Simple OCR attempt\n      const {\n        canvas,\n        ctx\n      } = this.setupCanvas(nameZone.width, nameZone.height);\n      ctx.putImageData(nameZone, 0, 0);\n      const dataUrl = canvas.toDataURL();\n      const worker = await Tesseract.createWorker();\n      await worker.setParameters({\n        tessedit_char_whitelist: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\\',. -',\n        tessedit_pageseg_mode: Tesseract.PSM.SINGLE_LINE\n      });\n      const {\n        data\n      } = await worker.recognize(dataUrl);\n      await worker.terminate();\n      const cleanText = this.cleanOCRText(data.text);\n      return {\n        success: data.confidence >= 50,\n        confidence: Math.round(data.confidence),\n        cardName: cleanText,\n        method: 'ocr_fallback'\n      };\n    } catch (error) {\n      this.log('‚ùå OCR fallback error:', error);\n      return {\n        success: false,\n        confidence: 0,\n        cardName: '',\n        method: 'ocr_failed'\n      };\n    }\n  }\n  extractNameZone(imageData) {\n    const zone = this.cardDimensions.nameZone;\n    const nameX = Math.floor(imageData.width * zone.x);\n    const nameY = Math.floor(imageData.height * zone.y);\n    const nameWidth = Math.floor(imageData.width * zone.width);\n    const nameHeight = Math.floor(imageData.height * zone.height);\n    const {\n      canvas,\n      ctx\n    } = this.setupCanvas(nameWidth, nameHeight);\n    const nameZoneData = ctx.createImageData(nameWidth, nameHeight);\n    for (let y = 0; y < nameHeight; y++) {\n      for (let x = 0; x < nameWidth; x++) {\n        const srcIndex = ((nameY + y) * imageData.width + (nameX + x)) * 4;\n        const dstIndex = (y * nameWidth + x) * 4;\n        for (let i = 0; i < 4; i++) {\n          nameZoneData.data[dstIndex + i] = imageData.data[srcIndex + i];\n        }\n      }\n    }\n    return nameZoneData;\n  }\n  cleanOCRText(text) {\n    if (!text) return '';\n    return text.replace(/[^\\w\\s',.-]/g, '').replace(/\\s+/g, ' ').trim().toLowerCase();\n  }\n  selectBestHybridResult(claudeResult, ocrResult, startTime) {\n    const processingTime = Date.now() - startTime;\n\n    // Claude Vision Success (Primary)\n    if (claudeResult && claudeResult.success && claudeResult.confidence >= 90) {\n      return {\n        hasCard: true,\n        cardName: claudeResult.cardName,\n        confidence: claudeResult.confidence,\n        detectionConfidence: claudeResult.confidence / 100,\n        method: `CLAUDE_VISION_SUCCESS`,\n        dimensions: '1280x720',\n        processingTime: processingTime,\n        strategy: 'claude_vision_primary'\n      };\n    }\n\n    // OCR Success (Fallback)\n    if (ocrResult && ocrResult.success && ocrResult.confidence >= 50) {\n      return {\n        hasCard: true,\n        cardName: ocrResult.cardName,\n        confidence: ocrResult.confidence,\n        detectionConfidence: ocrResult.confidence / 100,\n        method: `OCR_FALLBACK_SUCCESS`,\n        dimensions: '1280x720',\n        processingTime: processingTime,\n        strategy: 'ocr_fallback'\n      };\n    }\n\n    // No reliable recognition\n    const reason = !this.claudeEnabled ? 'CLAUDE_PROXY_NOT_RUNNING' : claudeResult && claudeResult.method === 'claude_vision_unclear' ? 'CLAUDE_UNCLEAR_IMAGE' : 'LOW_CONFIDENCE';\n    const message = !this.claudeEnabled ? 'Start Claude Proxy Server for 95% accuracy - currently using OCR fallback only' : claudeResult && claudeResult.method === 'claude_vision_unclear' ? 'Card image unclear to Claude Vision - try better lighting and stable positioning' : 'Card detected but recognition confidence too low - try better lighting';\n    return {\n      hasCard: false,\n      message: message,\n      reason: reason,\n      details: `Claude: ${this.claudeEnabled ? 'Running' : 'Not running'}, Processing time: ${processingTime}ms`,\n      processingTime: processingTime\n    };\n  }\n  setupCanvas(width, height) {\n    if (!this.canvas) {\n      this.canvas = document.createElement('canvas');\n      this.ctx = this.canvas.getContext('2d');\n    }\n    this.canvas.width = width;\n    this.canvas.height = height;\n    return {\n      canvas: this.canvas,\n      ctx: this.ctx\n    };\n  }\n  log(message, data = null) {\n    if (this.debugMode) {\n      console.log(`üéØ ${message}`, data || '');\n    }\n  }\n\n  // Compatibility methods\n  async scanCard(imageSrc, cardType = 'standard') {\n    this.log('üéØ scanCard() called - delegating to processVideoFrame()');\n    // For compatibility with existing code\n    return {\n      success: false,\n      confidence: 0\n    };\n  }\n  async processCardImage(imageSrc, cardType = 'standard') {\n    this.log('üéØ processCardImage() called - delegating to processVideoFrame()');\n    // For compatibility with existing code\n    return {\n      success: false,\n      confidence: 0\n    };\n  }\n}\nexport default ClaudeVisionService;","map":{"version":3,"names":["Tesseract","ClaudeVisionService","constructor","console","log","canvas","ctx","debugMode","proxyUrl","proxyHealthUrl","lastClaudeCall","claudeCallDelay","claudeEnabled","claudeResultCache","Map","cacheTimeout","knownCards","Set","cardDimensions","physicalWidth","physicalHeight","ratio","nameZone","x","y","width","height","checkProxyServer","response","fetch","data","json","status","apiKeyConfigured","warn","error","processVideoFrame","videoElement","document","createElement","getContext","videoWidth","videoHeight","drawImage","imageData","getImageData","startTime","Date","now","claudeResult","shouldCallClaude","callClaudeVisionProxy","ocrResult","success","enhancedOCRFallback","finalResult","selectBestHybridResult","method","confidence","cardName","hasCard","message","reason","details","timeSinceLastCall","base64Image","toDataURL","split","headers","body","JSON","stringify","prompt","ok","errorData","catch","Error","length","processingTime","apiCall","extractNameZone","setupCanvas","putImageData","dataUrl","worker","createWorker","setParameters","tessedit_char_whitelist","tessedit_pageseg_mode","PSM","SINGLE_LINE","recognize","terminate","cleanText","cleanOCRText","text","Math","round","zone","nameX","floor","nameY","nameWidth","nameHeight","nameZoneData","createImageData","srcIndex","dstIndex","i","replace","trim","toLowerCase","detectionConfidence","dimensions","strategy","scanCard","imageSrc","cardType","processCardImage"],"sources":["C:/Users/kim-a/Documents/DiceyTeck/MTG Scanner/src/ClaudeVisionService.js"],"sourcesContent":["import Tesseract from 'tesseract.js';\n\n// üöÄ CLAUDE VISION PROXY POWERED MTG SCANNER - NO CORS! üöÄ\nclass ClaudeVisionService {\n    constructor() {\n        console.log('üöÄ CLAUDE VISION PROXY POWERED MTG SCANNER initialized!');\n        this.canvas = null;\n        this.ctx = null;\n        this.debugMode = true;\n        \n        // ü§ñ CLAUDE VISION PROXY CONFIGURATION\n        this.proxyUrl = 'http://localhost:3001/api/claude-vision';\n        this.proxyHealthUrl = 'http://localhost:3001/health';\n        \n        // Rate limiting for Claude API calls\n        this.lastClaudeCall = 0;\n        this.claudeCallDelay = 2000; // 2 seconds between calls\n        this.claudeEnabled = true;\n        \n        // Cache for Claude results\n        this.claudeResultCache = new Map();\n        this.cacheTimeout = 8000; // 8 seconds cache\n        \n        // Enhanced known cards database for OCR fallback\n        this.knownCards = new Set([\n            'lightning bolt', 'black lotus', 'ancestral recall', 'time walk', 'mox pearl',\n            'mox sapphire', 'mox jet', 'mox ruby', 'mox emerald', 'counterspell',\n            'giant growth', 'dark ritual', 'healing salve', 'terror', 'disenchant',\n            'general ferrous rokiric', 'tarmogoyf', 'snapcaster mage', 'delver of secrets',\n            'monastery swiftspear', 'young pyromancer', 'lightning helix', 'path to exile',\n            'swords to plowshares', 'brainstorm', 'ponder', 'preordain', 'serum visions',\n            'solemn simulacrum', 'meteoric mace', 'cut your losses', 'blood researcher',\n            'fault line', 'okaun eye of chaos', 'roghakh son of rohgahh', 'gilded lotus',\n            'sol ring', 'mana crypt', 'chrome mox', 'mox diamond', 'lotus petal',\n            'demonic tutor', 'vampiric tutor', 'mystical tutor', 'enlightened tutor',\n            'force of will', 'force of negation', 'mana drain', 'cryptic command'\n        ]);\n        \n        // MTG card physical dimensions\n        this.cardDimensions = {\n            physicalWidth: 2.5,\n            physicalHeight: 3.5, \n            ratio: 2.5 / 3.5,\n            nameZone: {\n                x: 0.04, y: 0.025, width: 0.78, height: 0.09\n            }\n        };\n\n        // Check proxy server on initialization\n        this.checkProxyServer();\n    }\n\n    async checkProxyServer() {\n        try {\n            const response = await fetch(this.proxyHealthUrl);\n            const data = await response.json();\n            \n            if (data.status === 'OK') {\n                console.log('‚úÖ Claude Vision Proxy Server is running!');\n                if (data.apiKeyConfigured) {\n                    console.log('‚úÖ Proxy server has Claude API key configured');\n                    this.claudeEnabled = true;\n                } else {\n                    console.warn('‚ö†Ô∏è Proxy server needs Claude API key configuration');\n                    this.claudeEnabled = false;\n                }\n            }\n        } catch (error) {\n            console.warn('‚ö†Ô∏è Claude Vision Proxy Server not running - using OCR fallback only');\n            console.warn('üìã To enable Claude Vision: npm start in Claude Proxy Server directory');\n            this.claudeEnabled = false;\n        }\n    }\n\n    // üéØ MAIN CLAUDE VISION POWERED RECOGNITION METHOD\n    async processVideoFrame(videoElement) {\n        this.log('üé• Processing video frame with CLAUDE VISION PROXY + OCR HYBRID...');\n        \n        try {\n            // Capture frame\n            const canvas = document.createElement('canvas');\n            const ctx = canvas.getContext('2d');\n            canvas.width = videoElement.videoWidth;\n            canvas.height = videoElement.videoHeight;\n            ctx.drawImage(videoElement, 0, 0);\n            \n            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n            this.log('üì∑ Frame captured', `${imageData.width}x${imageData.height}`);\n            \n            // üéØ CLAUDE VISION FIRST APPROACH\n            const startTime = Date.now();\n            \n            // Step 1: Try Claude Vision API via Proxy (Primary)\n            let claudeResult = null;\n            if (this.claudeEnabled && this.shouldCallClaude()) {\n                this.log('ü§ñ Step 1: Calling Claude Vision via Proxy...');\n                claudeResult = await this.callClaudeVisionProxy(canvas);\n            } else if (!this.claudeEnabled) {\n                this.log('‚ö†Ô∏è Step 1: Claude Vision disabled (proxy not running)...');\n            } else {\n                this.log('‚è≥ Step 1: Skipping Claude (rate limit - waiting 2 seconds)...');\n            }\n            \n            // Step 2: OCR Fallback if needed\n            let ocrResult = null;\n            if (!claudeResult || !claudeResult.success) {\n                this.log('üîç Step 2: Running enhanced OCR fallback...');\n                ocrResult = await this.enhancedOCRFallback(imageData);\n            }\n            \n            // Step 3: Select best result\n            const finalResult = this.selectBestHybridResult(claudeResult, ocrResult, startTime);\n            \n            this.log('üéØ Final CLAUDE-POWERED result:', {\n                method: finalResult.method,\n                confidence: finalResult.confidence,\n                cardName: finalResult.cardName\n            });\n            \n            return finalResult;\n            \n        } catch (error) {\n            this.log('‚ùå Claude-powered processing error:', error);\n            return {\n                hasCard: false,\n                message: 'Scanner processing error: ' + error.message,\n                reason: 'PROCESSING_ERROR',\n                details: error.message\n            };\n        }\n    }\n\n    shouldCallClaude() {\n        const now = Date.now();\n        const timeSinceLastCall = now - this.lastClaudeCall;\n        return timeSinceLastCall >= this.claudeCallDelay;\n    }\n\n    async callClaudeVisionProxy(canvas) {\n        const startTime = Date.now();\n        \n        try {\n            this.log('ü§ñ Calling Claude Vision via Proxy Server...');\n            \n            // Convert canvas to base64\n            const base64Image = canvas.toDataURL('image/jpeg', 0.8).split(',')[1];\n            \n            // Call the proxy server instead of Claude API directly\n            const response = await fetch(this.proxyUrl, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                    base64Image: base64Image,\n                    prompt: `Analyze this Magic: The Gathering card image and identify the exact card name.\n\nINSTRUCTIONS:\n- Look carefully at the card name in the title area (top section of the card)\n- Return ONLY the exact card name as it appears on the card\n- If the text is unclear or unreadable, return \"UNCLEAR\"\n- Examples: \"Lightning Bolt\", \"Gilded Lotus\", \"Roghakh, Son of Rohgahh\"\n\nCard name:`\n                })\n            });\n            \n            this.lastClaudeCall = Date.now();\n            \n            if (!response.ok) {\n                const errorData = await response.json().catch(() => ({ error: 'Unknown error' }));\n                throw new Error(`Proxy server error: ${response.status} - ${errorData.error || 'Unknown error'}`);\n            }\n            \n            const data = await response.json();\n            const cardName = data.cardName;\n            \n            this.log('üéØ Claude Vision Proxy response:', cardName);\n            \n            // Validate response\n            if (cardName === 'UNCLEAR' || cardName.length < 2) {\n                return {\n                    success: false,\n                    confidence: 0,\n                    cardName: '',\n                    method: 'claude_vision_unclear',\n                    processingTime: Date.now() - startTime,\n                    reason: 'Image unclear to Claude Vision'\n                };\n            }\n            \n            // Success!\n            return {\n                success: true,\n                confidence: data.confidence || 95,\n                cardName: cardName,\n                method: 'claude_vision_proxy',\n                processingTime: Date.now() - startTime,\n                apiCall: true\n            };\n            \n        } catch (error) {\n            this.log('‚ùå Claude Vision Proxy error:', error.message);\n            return {\n                success: false,\n                confidence: 0,\n                cardName: '',\n                method: 'claude_vision_proxy_error',\n                processingTime: Date.now() - startTime,\n                error: error.message\n            };\n        }\n    }\n\n    async enhancedOCRFallback(imageData) {\n        this.log('üîç Running enhanced OCR fallback...');\n        \n        try {\n            // Extract name zone\n            const nameZone = this.extractNameZone(imageData);\n            \n            // Simple OCR attempt\n            const { canvas, ctx } = this.setupCanvas(nameZone.width, nameZone.height);\n            ctx.putImageData(nameZone, 0, 0);\n            const dataUrl = canvas.toDataURL();\n            \n            const worker = await Tesseract.createWorker();\n            await worker.setParameters({\n                tessedit_char_whitelist: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\\',. -',\n                tessedit_pageseg_mode: Tesseract.PSM.SINGLE_LINE\n            });\n            \n            const { data } = await worker.recognize(dataUrl);\n            await worker.terminate();\n            \n            const cleanText = this.cleanOCRText(data.text);\n            \n            return {\n                success: data.confidence >= 50,\n                confidence: Math.round(data.confidence),\n                cardName: cleanText,\n                method: 'ocr_fallback'\n            };\n            \n        } catch (error) {\n            this.log('‚ùå OCR fallback error:', error);\n            return {\n                success: false,\n                confidence: 0,\n                cardName: '',\n                method: 'ocr_failed'\n            };\n        }\n    }\n\n    extractNameZone(imageData) {\n        const zone = this.cardDimensions.nameZone;\n        \n        const nameX = Math.floor(imageData.width * zone.x);\n        const nameY = Math.floor(imageData.height * zone.y);\n        const nameWidth = Math.floor(imageData.width * zone.width);\n        const nameHeight = Math.floor(imageData.height * zone.height);\n        \n        const { canvas, ctx } = this.setupCanvas(nameWidth, nameHeight);\n        const nameZoneData = ctx.createImageData(nameWidth, nameHeight);\n        \n        for (let y = 0; y < nameHeight; y++) {\n            for (let x = 0; x < nameWidth; x++) {\n                const srcIndex = ((nameY + y) * imageData.width + (nameX + x)) * 4;\n                const dstIndex = (y * nameWidth + x) * 4;\n                \n                for (let i = 0; i < 4; i++) {\n                    nameZoneData.data[dstIndex + i] = imageData.data[srcIndex + i];\n                }\n            }\n        }\n        \n        return nameZoneData;\n    }\n\n    cleanOCRText(text) {\n        if (!text) return '';\n        \n        return text\n            .replace(/[^\\w\\s',.-]/g, '')\n            .replace(/\\s+/g, ' ')\n            .trim()\n            .toLowerCase();\n    }\n\n    selectBestHybridResult(claudeResult, ocrResult, startTime) {\n        const processingTime = Date.now() - startTime;\n        \n        // Claude Vision Success (Primary)\n        if (claudeResult && claudeResult.success && claudeResult.confidence >= 90) {\n            return {\n                hasCard: true,\n                cardName: claudeResult.cardName,\n                confidence: claudeResult.confidence,\n                detectionConfidence: claudeResult.confidence / 100,\n                method: `CLAUDE_VISION_SUCCESS`,\n                dimensions: '1280x720',\n                processingTime: processingTime,\n                strategy: 'claude_vision_primary'\n            };\n        }\n        \n        // OCR Success (Fallback)\n        if (ocrResult && ocrResult.success && ocrResult.confidence >= 50) {\n            return {\n                hasCard: true,\n                cardName: ocrResult.cardName,\n                confidence: ocrResult.confidence,\n                detectionConfidence: ocrResult.confidence / 100,\n                method: `OCR_FALLBACK_SUCCESS`,\n                dimensions: '1280x720',\n                processingTime: processingTime,\n                strategy: 'ocr_fallback'\n            };\n        }\n        \n        // No reliable recognition\n        const reason = !this.claudeEnabled ? 'CLAUDE_PROXY_NOT_RUNNING' : \n                      claudeResult && claudeResult.method === 'claude_vision_unclear' ? 'CLAUDE_UNCLEAR_IMAGE' :\n                      'LOW_CONFIDENCE';\n        \n        const message = !this.claudeEnabled ? \n            'Start Claude Proxy Server for 95% accuracy - currently using OCR fallback only' :\n            claudeResult && claudeResult.method === 'claude_vision_unclear' ?\n            'Card image unclear to Claude Vision - try better lighting and stable positioning' :\n            'Card detected but recognition confidence too low - try better lighting';\n        \n        return {\n            hasCard: false,\n            message: message,\n            reason: reason,\n            details: `Claude: ${this.claudeEnabled ? 'Running' : 'Not running'}, Processing time: ${processingTime}ms`,\n            processingTime: processingTime\n        };\n    }\n\n    setupCanvas(width, height) {\n        if (!this.canvas) {\n            this.canvas = document.createElement('canvas');\n            this.ctx = this.canvas.getContext('2d');\n        }\n        this.canvas.width = width;\n        this.canvas.height = height;\n        return { canvas: this.canvas, ctx: this.ctx };\n    }\n\n    log(message, data = null) {\n        if (this.debugMode) {\n            console.log(`üéØ ${message}`, data || '');\n        }\n    }\n\n    // Compatibility methods\n    async scanCard(imageSrc, cardType = 'standard') {\n        this.log('üéØ scanCard() called - delegating to processVideoFrame()');\n        // For compatibility with existing code\n        return { success: false, confidence: 0 };\n    }\n\n    async processCardImage(imageSrc, cardType = 'standard') {\n        this.log('üéØ processCardImage() called - delegating to processVideoFrame()');\n        // For compatibility with existing code\n        return { success: false, confidence: 0 };\n    }\n}\n\nexport default ClaudeVisionService;"],"mappings":"AAAA,OAAOA,SAAS,MAAM,cAAc;;AAEpC;AACA,MAAMC,mBAAmB,CAAC;EACtBC,WAAWA,CAAA,EAAG;IACVC,OAAO,CAACC,GAAG,CAAC,yDAAyD,CAAC;IACtE,IAAI,CAACC,MAAM,GAAG,IAAI;IAClB,IAAI,CAACC,GAAG,GAAG,IAAI;IACf,IAAI,CAACC,SAAS,GAAG,IAAI;;IAErB;IACA,IAAI,CAACC,QAAQ,GAAG,yCAAyC;IACzD,IAAI,CAACC,cAAc,GAAG,8BAA8B;;IAEpD;IACA,IAAI,CAACC,cAAc,GAAG,CAAC;IACvB,IAAI,CAACC,eAAe,GAAG,IAAI,CAAC,CAAC;IAC7B,IAAI,CAACC,aAAa,GAAG,IAAI;;IAEzB;IACA,IAAI,CAACC,iBAAiB,GAAG,IAAIC,GAAG,CAAC,CAAC;IAClC,IAAI,CAACC,YAAY,GAAG,IAAI,CAAC,CAAC;;IAE1B;IACA,IAAI,CAACC,UAAU,GAAG,IAAIC,GAAG,CAAC,CACtB,gBAAgB,EAAE,aAAa,EAAE,kBAAkB,EAAE,WAAW,EAAE,WAAW,EAC7E,cAAc,EAAE,SAAS,EAAE,UAAU,EAAE,aAAa,EAAE,cAAc,EACpE,cAAc,EAAE,aAAa,EAAE,eAAe,EAAE,QAAQ,EAAE,YAAY,EACtE,yBAAyB,EAAE,WAAW,EAAE,iBAAiB,EAAE,mBAAmB,EAC9E,sBAAsB,EAAE,kBAAkB,EAAE,iBAAiB,EAAE,eAAe,EAC9E,sBAAsB,EAAE,YAAY,EAAE,QAAQ,EAAE,WAAW,EAAE,eAAe,EAC5E,mBAAmB,EAAE,eAAe,EAAE,iBAAiB,EAAE,kBAAkB,EAC3E,YAAY,EAAE,oBAAoB,EAAE,wBAAwB,EAAE,cAAc,EAC5E,UAAU,EAAE,YAAY,EAAE,YAAY,EAAE,aAAa,EAAE,aAAa,EACpE,eAAe,EAAE,gBAAgB,EAAE,gBAAgB,EAAE,mBAAmB,EACxE,eAAe,EAAE,mBAAmB,EAAE,YAAY,EAAE,iBAAiB,CACxE,CAAC;;IAEF;IACA,IAAI,CAACC,cAAc,GAAG;MAClBC,aAAa,EAAE,GAAG;MAClBC,cAAc,EAAE,GAAG;MACnBC,KAAK,EAAE,GAAG,GAAG,GAAG;MAChBC,QAAQ,EAAE;QACNC,CAAC,EAAE,IAAI;QAAEC,CAAC,EAAE,KAAK;QAAEC,KAAK,EAAE,IAAI;QAAEC,MAAM,EAAE;MAC5C;IACJ,CAAC;;IAED;IACA,IAAI,CAACC,gBAAgB,CAAC,CAAC;EAC3B;EAEA,MAAMA,gBAAgBA,CAAA,EAAG;IACrB,IAAI;MACA,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,IAAI,CAACpB,cAAc,CAAC;MACjD,MAAMqB,IAAI,GAAG,MAAMF,QAAQ,CAACG,IAAI,CAAC,CAAC;MAElC,IAAID,IAAI,CAACE,MAAM,KAAK,IAAI,EAAE;QACtB7B,OAAO,CAACC,GAAG,CAAC,0CAA0C,CAAC;QACvD,IAAI0B,IAAI,CAACG,gBAAgB,EAAE;UACvB9B,OAAO,CAACC,GAAG,CAAC,8CAA8C,CAAC;UAC3D,IAAI,CAACQ,aAAa,GAAG,IAAI;QAC7B,CAAC,MAAM;UACHT,OAAO,CAAC+B,IAAI,CAAC,oDAAoD,CAAC;UAClE,IAAI,CAACtB,aAAa,GAAG,KAAK;QAC9B;MACJ;IACJ,CAAC,CAAC,OAAOuB,KAAK,EAAE;MACZhC,OAAO,CAAC+B,IAAI,CAAC,qEAAqE,CAAC;MACnF/B,OAAO,CAAC+B,IAAI,CAAC,wEAAwE,CAAC;MACtF,IAAI,CAACtB,aAAa,GAAG,KAAK;IAC9B;EACJ;;EAEA;EACA,MAAMwB,iBAAiBA,CAACC,YAAY,EAAE;IAClC,IAAI,CAACjC,GAAG,CAAC,oEAAoE,CAAC;IAE9E,IAAI;MACA;MACA,MAAMC,MAAM,GAAGiC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;MAC/C,MAAMjC,GAAG,GAAGD,MAAM,CAACmC,UAAU,CAAC,IAAI,CAAC;MACnCnC,MAAM,CAACoB,KAAK,GAAGY,YAAY,CAACI,UAAU;MACtCpC,MAAM,CAACqB,MAAM,GAAGW,YAAY,CAACK,WAAW;MACxCpC,GAAG,CAACqC,SAAS,CAACN,YAAY,EAAE,CAAC,EAAE,CAAC,CAAC;MAEjC,MAAMO,SAAS,GAAGtC,GAAG,CAACuC,YAAY,CAAC,CAAC,EAAE,CAAC,EAAExC,MAAM,CAACoB,KAAK,EAAEpB,MAAM,CAACqB,MAAM,CAAC;MACrE,IAAI,CAACtB,GAAG,CAAC,mBAAmB,EAAE,GAAGwC,SAAS,CAACnB,KAAK,IAAImB,SAAS,CAAClB,MAAM,EAAE,CAAC;;MAEvE;MACA,MAAMoB,SAAS,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC;;MAE5B;MACA,IAAIC,YAAY,GAAG,IAAI;MACvB,IAAI,IAAI,CAACrC,aAAa,IAAI,IAAI,CAACsC,gBAAgB,CAAC,CAAC,EAAE;QAC/C,IAAI,CAAC9C,GAAG,CAAC,+CAA+C,CAAC;QACzD6C,YAAY,GAAG,MAAM,IAAI,CAACE,qBAAqB,CAAC9C,MAAM,CAAC;MAC3D,CAAC,MAAM,IAAI,CAAC,IAAI,CAACO,aAAa,EAAE;QAC5B,IAAI,CAACR,GAAG,CAAC,0DAA0D,CAAC;MACxE,CAAC,MAAM;QACH,IAAI,CAACA,GAAG,CAAC,+DAA+D,CAAC;MAC7E;;MAEA;MACA,IAAIgD,SAAS,GAAG,IAAI;MACpB,IAAI,CAACH,YAAY,IAAI,CAACA,YAAY,CAACI,OAAO,EAAE;QACxC,IAAI,CAACjD,GAAG,CAAC,6CAA6C,CAAC;QACvDgD,SAAS,GAAG,MAAM,IAAI,CAACE,mBAAmB,CAACV,SAAS,CAAC;MACzD;;MAEA;MACA,MAAMW,WAAW,GAAG,IAAI,CAACC,sBAAsB,CAACP,YAAY,EAAEG,SAAS,EAAEN,SAAS,CAAC;MAEnF,IAAI,CAAC1C,GAAG,CAAC,iCAAiC,EAAE;QACxCqD,MAAM,EAAEF,WAAW,CAACE,MAAM;QAC1BC,UAAU,EAAEH,WAAW,CAACG,UAAU;QAClCC,QAAQ,EAAEJ,WAAW,CAACI;MAC1B,CAAC,CAAC;MAEF,OAAOJ,WAAW;IAEtB,CAAC,CAAC,OAAOpB,KAAK,EAAE;MACZ,IAAI,CAAC/B,GAAG,CAAC,oCAAoC,EAAE+B,KAAK,CAAC;MACrD,OAAO;QACHyB,OAAO,EAAE,KAAK;QACdC,OAAO,EAAE,4BAA4B,GAAG1B,KAAK,CAAC0B,OAAO;QACrDC,MAAM,EAAE,kBAAkB;QAC1BC,OAAO,EAAE5B,KAAK,CAAC0B;MACnB,CAAC;IACL;EACJ;EAEAX,gBAAgBA,CAAA,EAAG;IACf,MAAMF,GAAG,GAAGD,IAAI,CAACC,GAAG,CAAC,CAAC;IACtB,MAAMgB,iBAAiB,GAAGhB,GAAG,GAAG,IAAI,CAACtC,cAAc;IACnD,OAAOsD,iBAAiB,IAAI,IAAI,CAACrD,eAAe;EACpD;EAEA,MAAMwC,qBAAqBA,CAAC9C,MAAM,EAAE;IAChC,MAAMyC,SAAS,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC;IAE5B,IAAI;MACA,IAAI,CAAC5C,GAAG,CAAC,8CAA8C,CAAC;;MAExD;MACA,MAAM6D,WAAW,GAAG5D,MAAM,CAAC6D,SAAS,CAAC,YAAY,EAAE,GAAG,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;;MAErE;MACA,MAAMvC,QAAQ,GAAG,MAAMC,KAAK,CAAC,IAAI,CAACrB,QAAQ,EAAE;QACxCiD,MAAM,EAAE,MAAM;QACdW,OAAO,EAAE;UACL,cAAc,EAAE;QACpB,CAAC;QACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UACjBN,WAAW,EAAEA,WAAW;UACxBO,MAAM,EAAE;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;QACgB,CAAC;MACL,CAAC,CAAC;MAEF,IAAI,CAAC9D,cAAc,GAAGqC,IAAI,CAACC,GAAG,CAAC,CAAC;MAEhC,IAAI,CAACpB,QAAQ,CAAC6C,EAAE,EAAE;QACd,MAAMC,SAAS,GAAG,MAAM9C,QAAQ,CAACG,IAAI,CAAC,CAAC,CAAC4C,KAAK,CAAC,OAAO;UAAExC,KAAK,EAAE;QAAgB,CAAC,CAAC,CAAC;QACjF,MAAM,IAAIyC,KAAK,CAAC,uBAAuBhD,QAAQ,CAACI,MAAM,MAAM0C,SAAS,CAACvC,KAAK,IAAI,eAAe,EAAE,CAAC;MACrG;MAEA,MAAML,IAAI,GAAG,MAAMF,QAAQ,CAACG,IAAI,CAAC,CAAC;MAClC,MAAM4B,QAAQ,GAAG7B,IAAI,CAAC6B,QAAQ;MAE9B,IAAI,CAACvD,GAAG,CAAC,kCAAkC,EAAEuD,QAAQ,CAAC;;MAEtD;MACA,IAAIA,QAAQ,KAAK,SAAS,IAAIA,QAAQ,CAACkB,MAAM,GAAG,CAAC,EAAE;QAC/C,OAAO;UACHxB,OAAO,EAAE,KAAK;UACdK,UAAU,EAAE,CAAC;UACbC,QAAQ,EAAE,EAAE;UACZF,MAAM,EAAE,uBAAuB;UAC/BqB,cAAc,EAAE/B,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGF,SAAS;UACtCgB,MAAM,EAAE;QACZ,CAAC;MACL;;MAEA;MACA,OAAO;QACHT,OAAO,EAAE,IAAI;QACbK,UAAU,EAAE5B,IAAI,CAAC4B,UAAU,IAAI,EAAE;QACjCC,QAAQ,EAAEA,QAAQ;QAClBF,MAAM,EAAE,qBAAqB;QAC7BqB,cAAc,EAAE/B,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGF,SAAS;QACtCiC,OAAO,EAAE;MACb,CAAC;IAEL,CAAC,CAAC,OAAO5C,KAAK,EAAE;MACZ,IAAI,CAAC/B,GAAG,CAAC,8BAA8B,EAAE+B,KAAK,CAAC0B,OAAO,CAAC;MACvD,OAAO;QACHR,OAAO,EAAE,KAAK;QACdK,UAAU,EAAE,CAAC;QACbC,QAAQ,EAAE,EAAE;QACZF,MAAM,EAAE,2BAA2B;QACnCqB,cAAc,EAAE/B,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGF,SAAS;QACtCX,KAAK,EAAEA,KAAK,CAAC0B;MACjB,CAAC;IACL;EACJ;EAEA,MAAMP,mBAAmBA,CAACV,SAAS,EAAE;IACjC,IAAI,CAACxC,GAAG,CAAC,qCAAqC,CAAC;IAE/C,IAAI;MACA;MACA,MAAMkB,QAAQ,GAAG,IAAI,CAAC0D,eAAe,CAACpC,SAAS,CAAC;;MAEhD;MACA,MAAM;QAAEvC,MAAM;QAAEC;MAAI,CAAC,GAAG,IAAI,CAAC2E,WAAW,CAAC3D,QAAQ,CAACG,KAAK,EAAEH,QAAQ,CAACI,MAAM,CAAC;MACzEpB,GAAG,CAAC4E,YAAY,CAAC5D,QAAQ,EAAE,CAAC,EAAE,CAAC,CAAC;MAChC,MAAM6D,OAAO,GAAG9E,MAAM,CAAC6D,SAAS,CAAC,CAAC;MAElC,MAAMkB,MAAM,GAAG,MAAMpF,SAAS,CAACqF,YAAY,CAAC,CAAC;MAC7C,MAAMD,MAAM,CAACE,aAAa,CAAC;QACvBC,uBAAuB,EAAE,4DAA4D;QACrFC,qBAAqB,EAAExF,SAAS,CAACyF,GAAG,CAACC;MACzC,CAAC,CAAC;MAEF,MAAM;QAAE5D;MAAK,CAAC,GAAG,MAAMsD,MAAM,CAACO,SAAS,CAACR,OAAO,CAAC;MAChD,MAAMC,MAAM,CAACQ,SAAS,CAAC,CAAC;MAExB,MAAMC,SAAS,GAAG,IAAI,CAACC,YAAY,CAAChE,IAAI,CAACiE,IAAI,CAAC;MAE9C,OAAO;QACH1C,OAAO,EAAEvB,IAAI,CAAC4B,UAAU,IAAI,EAAE;QAC9BA,UAAU,EAAEsC,IAAI,CAACC,KAAK,CAACnE,IAAI,CAAC4B,UAAU,CAAC;QACvCC,QAAQ,EAAEkC,SAAS;QACnBpC,MAAM,EAAE;MACZ,CAAC;IAEL,CAAC,CAAC,OAAOtB,KAAK,EAAE;MACZ,IAAI,CAAC/B,GAAG,CAAC,uBAAuB,EAAE+B,KAAK,CAAC;MACxC,OAAO;QACHkB,OAAO,EAAE,KAAK;QACdK,UAAU,EAAE,CAAC;QACbC,QAAQ,EAAE,EAAE;QACZF,MAAM,EAAE;MACZ,CAAC;IACL;EACJ;EAEAuB,eAAeA,CAACpC,SAAS,EAAE;IACvB,MAAMsD,IAAI,GAAG,IAAI,CAAChF,cAAc,CAACI,QAAQ;IAEzC,MAAM6E,KAAK,GAAGH,IAAI,CAACI,KAAK,CAACxD,SAAS,CAACnB,KAAK,GAAGyE,IAAI,CAAC3E,CAAC,CAAC;IAClD,MAAM8E,KAAK,GAAGL,IAAI,CAACI,KAAK,CAACxD,SAAS,CAAClB,MAAM,GAAGwE,IAAI,CAAC1E,CAAC,CAAC;IACnD,MAAM8E,SAAS,GAAGN,IAAI,CAACI,KAAK,CAACxD,SAAS,CAACnB,KAAK,GAAGyE,IAAI,CAACzE,KAAK,CAAC;IAC1D,MAAM8E,UAAU,GAAGP,IAAI,CAACI,KAAK,CAACxD,SAAS,CAAClB,MAAM,GAAGwE,IAAI,CAACxE,MAAM,CAAC;IAE7D,MAAM;MAAErB,MAAM;MAAEC;IAAI,CAAC,GAAG,IAAI,CAAC2E,WAAW,CAACqB,SAAS,EAAEC,UAAU,CAAC;IAC/D,MAAMC,YAAY,GAAGlG,GAAG,CAACmG,eAAe,CAACH,SAAS,EAAEC,UAAU,CAAC;IAE/D,KAAK,IAAI/E,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG+E,UAAU,EAAE/E,CAAC,EAAE,EAAE;MACjC,KAAK,IAAID,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG+E,SAAS,EAAE/E,CAAC,EAAE,EAAE;QAChC,MAAMmF,QAAQ,GAAG,CAAC,CAACL,KAAK,GAAG7E,CAAC,IAAIoB,SAAS,CAACnB,KAAK,IAAI0E,KAAK,GAAG5E,CAAC,CAAC,IAAI,CAAC;QAClE,MAAMoF,QAAQ,GAAG,CAACnF,CAAC,GAAG8E,SAAS,GAAG/E,CAAC,IAAI,CAAC;QAExC,KAAK,IAAIqF,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,CAAC,EAAEA,CAAC,EAAE,EAAE;UACxBJ,YAAY,CAAC1E,IAAI,CAAC6E,QAAQ,GAAGC,CAAC,CAAC,GAAGhE,SAAS,CAACd,IAAI,CAAC4E,QAAQ,GAAGE,CAAC,CAAC;QAClE;MACJ;IACJ;IAEA,OAAOJ,YAAY;EACvB;EAEAV,YAAYA,CAACC,IAAI,EAAE;IACf,IAAI,CAACA,IAAI,EAAE,OAAO,EAAE;IAEpB,OAAOA,IAAI,CACNc,OAAO,CAAC,cAAc,EAAE,EAAE,CAAC,CAC3BA,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC,CACpBC,IAAI,CAAC,CAAC,CACNC,WAAW,CAAC,CAAC;EACtB;EAEAvD,sBAAsBA,CAACP,YAAY,EAAEG,SAAS,EAAEN,SAAS,EAAE;IACvD,MAAMgC,cAAc,GAAG/B,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGF,SAAS;;IAE7C;IACA,IAAIG,YAAY,IAAIA,YAAY,CAACI,OAAO,IAAIJ,YAAY,CAACS,UAAU,IAAI,EAAE,EAAE;MACvE,OAAO;QACHE,OAAO,EAAE,IAAI;QACbD,QAAQ,EAAEV,YAAY,CAACU,QAAQ;QAC/BD,UAAU,EAAET,YAAY,CAACS,UAAU;QACnCsD,mBAAmB,EAAE/D,YAAY,CAACS,UAAU,GAAG,GAAG;QAClDD,MAAM,EAAE,uBAAuB;QAC/BwD,UAAU,EAAE,UAAU;QACtBnC,cAAc,EAAEA,cAAc;QAC9BoC,QAAQ,EAAE;MACd,CAAC;IACL;;IAEA;IACA,IAAI9D,SAAS,IAAIA,SAAS,CAACC,OAAO,IAAID,SAAS,CAACM,UAAU,IAAI,EAAE,EAAE;MAC9D,OAAO;QACHE,OAAO,EAAE,IAAI;QACbD,QAAQ,EAAEP,SAAS,CAACO,QAAQ;QAC5BD,UAAU,EAAEN,SAAS,CAACM,UAAU;QAChCsD,mBAAmB,EAAE5D,SAAS,CAACM,UAAU,GAAG,GAAG;QAC/CD,MAAM,EAAE,sBAAsB;QAC9BwD,UAAU,EAAE,UAAU;QACtBnC,cAAc,EAAEA,cAAc;QAC9BoC,QAAQ,EAAE;MACd,CAAC;IACL;;IAEA;IACA,MAAMpD,MAAM,GAAG,CAAC,IAAI,CAAClD,aAAa,GAAG,0BAA0B,GACjDqC,YAAY,IAAIA,YAAY,CAACQ,MAAM,KAAK,uBAAuB,GAAG,sBAAsB,GACxF,gBAAgB;IAE9B,MAAMI,OAAO,GAAG,CAAC,IAAI,CAACjD,aAAa,GAC/B,gFAAgF,GAChFqC,YAAY,IAAIA,YAAY,CAACQ,MAAM,KAAK,uBAAuB,GAC/D,kFAAkF,GAClF,wEAAwE;IAE5E,OAAO;MACHG,OAAO,EAAE,KAAK;MACdC,OAAO,EAAEA,OAAO;MAChBC,MAAM,EAAEA,MAAM;MACdC,OAAO,EAAE,WAAW,IAAI,CAACnD,aAAa,GAAG,SAAS,GAAG,aAAa,sBAAsBkE,cAAc,IAAI;MAC1GA,cAAc,EAAEA;IACpB,CAAC;EACL;EAEAG,WAAWA,CAACxD,KAAK,EAAEC,MAAM,EAAE;IACvB,IAAI,CAAC,IAAI,CAACrB,MAAM,EAAE;MACd,IAAI,CAACA,MAAM,GAAGiC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;MAC9C,IAAI,CAACjC,GAAG,GAAG,IAAI,CAACD,MAAM,CAACmC,UAAU,CAAC,IAAI,CAAC;IAC3C;IACA,IAAI,CAACnC,MAAM,CAACoB,KAAK,GAAGA,KAAK;IACzB,IAAI,CAACpB,MAAM,CAACqB,MAAM,GAAGA,MAAM;IAC3B,OAAO;MAAErB,MAAM,EAAE,IAAI,CAACA,MAAM;MAAEC,GAAG,EAAE,IAAI,CAACA;IAAI,CAAC;EACjD;EAEAF,GAAGA,CAACyD,OAAO,EAAE/B,IAAI,GAAG,IAAI,EAAE;IACtB,IAAI,IAAI,CAACvB,SAAS,EAAE;MAChBJ,OAAO,CAACC,GAAG,CAAC,MAAMyD,OAAO,EAAE,EAAE/B,IAAI,IAAI,EAAE,CAAC;IAC5C;EACJ;;EAEA;EACA,MAAMqF,QAAQA,CAACC,QAAQ,EAAEC,QAAQ,GAAG,UAAU,EAAE;IAC5C,IAAI,CAACjH,GAAG,CAAC,0DAA0D,CAAC;IACpE;IACA,OAAO;MAAEiD,OAAO,EAAE,KAAK;MAAEK,UAAU,EAAE;IAAE,CAAC;EAC5C;EAEA,MAAM4D,gBAAgBA,CAACF,QAAQ,EAAEC,QAAQ,GAAG,UAAU,EAAE;IACpD,IAAI,CAACjH,GAAG,CAAC,kEAAkE,CAAC;IAC5E;IACA,OAAO;MAAEiD,OAAO,EAAE,KAAK;MAAEK,UAAU,EAAE;IAAE,CAAC;EAC5C;AACJ;AAEA,eAAezD,mBAAmB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}